<div class="container mx-auto px-4 py-4">
  <!-- Vista de Historial -->
  @if (isHistorialView) {
  <div class="mb-4 flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center">
    <div class="w-full sm:max-w-md">
      <app-search-bar placeholder="Buscar por ID, cliente, comprobante..." (search)="onSearch($event)">
      </app-search-bar>
    </div>
    <div class="flex flex-wrap gap-2 w-full sm:w-auto">
      <!-- Botones de Reportes PDF -->
      <button (click)="exportarReporteDetallado()" 
        class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition duration-300 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        <span class="hidden sm:inline">Reporte Detallado</span>
      </button>
      <button (click)="exportarReporteGeneral()" 
        class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition duration-300 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        <span class="hidden sm:inline">Reporte General</span>
      </button>
      <select [(ngModel)]="filterEstado" (change)="onFilterChange()"
        class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white flex-1 sm:flex-none">
        <option value="">Todos los estados</option>
        <option value="1">Completadas</option>
        <option value="0">Anuladas</option>
      </select>

      @if (isAdmin) {
      <select [(ngModel)]="filterSucursalId" (change)="onFilterChange()"
        class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white flex-1 sm:flex-none">
        <option value="">Todas las sucursales</option>
        @for (sucursal of sucursales; track sucursal.id) {
        <option [value]="sucursal.id">{{ sucursal.nombre }}</option>
        }
      </select>
      }

      <div
        class="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg bg-white dark:bg-slate-700 dark:border-slate-600 flex-1 sm:flex-none">
        <input type="checkbox" id="chkDevoluciones" [(ngModel)]="filterDevoluciones" (change)="onFilterChange()"
          class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
        <label for="chkDevoluciones" class="text-sm text-gray-700 dark:text-slate-300 whitespace-nowrap">Con
          Devoluciones</label>
      </div>
    </div>
  </div>

  <app-ventas-history [ventas]="ventas" [isLoading]="isLoading" (nuevaVenta)="navegarANuevaVenta()"
    (verDetalle)="verDetalleVenta($event)" (devolverVenta)="onDevolverVenta($event)"
    (anularVenta)="onAnularVenta($event)" (imprimirComprobante)="onImprimirComprobante($event)">
  </app-ventas-history>

  <app-pagination [currentPage]="currentPage" [lastPage]="lastPage" [total]="total" [perPage]="perPage"
    (pageChange)="onPageChange($event)">
  </app-pagination>

  <app-venta-detail-modal [venta]="selectedVenta" [isOpen]="isDetailModalOpen" (close)="closeDetailModal()"
    (print)="onImprimirComprobante($event)">
  </app-venta-detail-modal>
  }

  <!-- Formulario de Nueva Venta -->
  @if (!isHistorialView) {
  <app-venta-form (saleCompleted)="onSaleCompleted()">
  </app-venta-form>
  }
</div>